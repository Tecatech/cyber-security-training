#!/usr/bin/env python3
from pwn import *

key = 'yactf{'

f = ['None'] * 20
f[0] = 8
f[3] = 0
f[4] = '-'
f[6] = 5
f[8] = 6
f[9] = '-'
f[10] = 7
f[11] = 8
f[12] = 2
f[14] = '-'
f[15] = 3
f[16] = 4
f[17] = 7
f[19] = '}'

for f[5] in range(1, 8):
    for f[13] in range(2, 10):
        for f[18] in range(3, 9):
            for f[1] in range(0, 10):
                for f[7] in range(1, 8):
                    for f[2] in range(0, 10):
                        v7 = f[2] + f[1] + 8 + f[3]
                        v8 = f[12] + f[11] + f[10] + f[13]
                        
                        if ((f[17] + f[16] + f[15] + f[18]) != (f[7] + f[6] + f[5] + f[8] + v7 + v8) / 3):
                            continue
                        if ((v8 + v7) != 33):
                            continue
                        if ((f[5] + v8) != 31):
                            continue
                        
                        p = process('./crackme.elf')
                        p.recvline()
                        
                        key += ''.join(str(char) for char in f)
                        p.sendline(key.encode())
                        
                        data = p.recvlineS()
                        if (len(key) == 26 and 'Congrats!' in data):
                            print(key)
                        
                        p.close()