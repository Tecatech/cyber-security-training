from flask import Flask
from db import connection

app = Flask(__name__, static_folder="static",  template_folder='templates')
app.secret_key = "W1nn3rW1nn3rFl4gsF0rD1nn3r"

import routes


@app.before_first_request
def init_db():
    cursor = connection.cursor()
    query = """
        CREATE TABLE IF NOT EXISTS users(
            id INT PRIMARY KEY AUTO_INCREMENT,
            username varchar(255),
            password varchar(255)  )"""
    cursor.execute(query)

    query = """
        CREATE TABLE IF NOT EXISTS bottles(
            id INT PRIMARY KEY AUTO_INCREMENT,
            bottle_name varchar(255),
            username varchar(255),
            bottle_secret INTEGER
    )"""
    cursor.execute(query)

    query = """
        CREATE TABLE IF NOT EXISTS cocktails(
            id INT PRIMARY KEY AUTO_INCREMENT,
            cocktail_name varchar(255),
            username varchar(255),
            first varchar(255),
            second varchar(255),
            cocktail_secret INTEGER,
            cocktail_known INTEGER,
            description varchar(255)
    )"""
    cursor.execute(query)

    connection.commit()


if __name__ == '__main__':
    app.run(host='0.0.0.0', port=777, debug=True)
